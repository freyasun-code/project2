<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project1: Images of the Russian Empire</title>
  <style>
    body {
      background-color: #D8C3DD; /* 紫色背景 */
      font-family: Arial, sans-serif;
      color: white;
      margin: 0;
      padding: 0;
    }
    /* 导航栏 */
    nav {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav a {
      color: #ffddff;
      text-decoration: none;
      margin: 0 15px;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }
    .container {
      width: 80%;
      margin: auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-top: 20px;
    }
    .section {
      background: rgba(0,0,0,0.2);
      padding: 20px;
      margin: 40px 0;
      border-radius: 12px;
    }
    .section h2 {
      color: #ffddff;
      text-align: center;
    }
    img {
      max-width: 100%;
      border-radius: 8px;
    }
    .row {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .img-block {
      text-align: center;
    }
    .img-block p {
      margin-top: 8px;
      font-size: 16px;
      text-align: center;
    }
    p {
      text-align: left;
      max-width: 1000px;
      margin: auto;
      margin-bottom: 20px;
      font-size: 18px;
    }
  </style>
  <!-- MathJax 支持公式渲染 -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <!-- 导航栏 -->
  <nav>
    <a href="#part1">Part1</a>
    <a href="#part2">Part2</a>
    <a href="#part3">Part3</a>
    <a href="#part4">Part4</a>
  </nav>

  <div class="container">
    <h1>Project1: Images of the Russian Empire: Colorizing the Prokudin-Gorskii photo collection</h1>
    <p style="text-align:center; font-style:italic;">Freya Sun</p>

<!-- Part 1: Fun with Filters -->
<div class="section" id="filters">
  <h2>Part 1: Fun with Filters</h2>

  <!-- Part 1.1: Convolutions from Scratch -->
  <h3 style="margin-top:20px; text-align:center;">Part 1.1: Convolutions from Scratch!</h3>
  <p style="text-align:left; max-width:800px; margin:auto; margin-bottom:20px; font-size:18px;">
    In this section, I implemented convolution operations from scratch using numpy. I created a 9x9 box filter and finite difference operators (Dx and Dy) to explore basic image filtering. 
    The results include the original grayscale image, blurred image using the box filter, horizontal and vertical edge detection, and the combined edge magnitude.
  </p>

  <!-- 5 张图并排 -->
  <div style="display: flex; justify-content: center; gap:30px; flex-wrap: wrap; margin-top:20px;">
    <div style="text-align: center;">
      <img src="original_gray.jpg" alt="Original Gray" width="200">
      <p>Original (Gray)</p>
    </div>
    <div style="text-align: center;">
      <img src="blurred_box9.jpg" alt="Blurred Box Filter" width="200">
      <p>Blurred (9x9 Box Filter)</p>
    </div>
    <div style="text-align: center;">
      <img src="edge_dx.jpg" alt="Edge Dx" width="200">
      <p>Edge Dx</p>
    </div>
    <div style="text-align: center;">
      <img src="edge_dy.jpg" alt="Edge Dy" width="200">
      <p>Edge Dy</p>
    </div>
    <div style="text-align: center;">
      <img src="edge_combined.jpg" alt="Edge Combined" width="200">
      <p>Edges (Combined Magnitude)</p>
    </div>
  </div>

  <!-- Part 1.2: Finite Difference Operator -->
<h3 style="margin-top:40px; text-align:center;">Part 1.2: Finite Difference Operator</h3>
<p style="text-align:left; max-width:800px; margin:auto; margin-bottom:20px; font-size:18px;">
  Here I explored the finite difference operators for edge detection. By applying Dx and Dy, I was able to approximate the gradient of the image in horizontal and vertical directions. 
  Combining them gives the gradient magnitude, and by applying a threshold, we can highlight the edges in the image.
</p>

<!-- 四张图并排 -->
<div style="display: flex; justify-content: center; gap:40px; margin-top:20px;">
  <figure style="text-align:center; margin:0;">
    <img src="Ix.jpg" alt="Ix" width="220">
    <figcaption>Ix (∂I/∂x)</figcaption>
  </figure>
  <figure style="text-align:center; margin:0;">
    <img src="Iy.jpg" alt="Iy" width="220">
    <figcaption>Iy (∂I/∂y)</figcaption>
  </figure>
  <figure style="text-align:center; margin:0;">
    <img src="grad_mag.jpg" alt="Gradient Magnitude" width="220">
    <figcaption>Gradient Magnitude</figcaption>
  </figure>
  <figure style="text-align:center; margin:0;">
    <img src="edge_img.jpg" alt="Edge Image" width="220">
    <figcaption>Edge Image (Thresholded)</figcaption>
  </figure>
</div>




<!-- Part 1.3: Derivative of Gaussian (DoG) Filter -->
<h3 style="margin-top:40px; text-align:center;">Part 1.3: Derivative of Gaussian (DoG) Filter</h3>
<p style="text-align:left; max-width:800px; margin:auto; margin-bottom:20px; font-size:18px;">
  In this section, I implemented the Derivative of Gaussian filter to combine smoothing and differentiation in one operation. This allows edge detection while reducing noise in the image.
</p>

<!-- 图片展示区域 -->
<div style="display:flex; justify-content:center; flex-wrap:wrap; gap:30px; max-width:1000px; margin:auto;">

  <!-- 第一行三张 -->
  <div style="text-align:center; width:250px;">
    <img src="Blur.jpg" alt="Blur" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Blur</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="Ix_blur.jpg" alt="Ix (Blurred)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Ix (Blurred)</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="Iy_blur.jpg" alt="Iy (Blurred)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Iy (Blurred)</div>
  </div>

  <!-- 第二行两张 -->
  <div style="text-align:center; width:250px;">
    <img src="GradMag_blur.jpg" alt="Grad Mag (Blurred)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Grad Mag (Blurred)</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="GradMag_DoG.jpg" alt="Grad Mag (DoG)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Grad Mag (DoG)</div>
  </div>

</div>

<!-- Part 2: Fun with Frequencies! -->
<h2 style="margin-top:50px; text-align:center;">Part 2: Fun with Frequencies!</h2>

<!-- Part 2.1: Image "Sharpening" -->
<h3 style="margin-top:30px; text-align:center;">Part 2.1: Image "Sharpening"</h3>
<p style="text-align:left; max-width:800px; margin:auto; margin-bottom:20px; font-size:18px;">
  In this section, I applied the unsharp masking technique. By subtracting the low-frequency content from the original image and then adding it back with a scale, we can enhance high-frequency details and make the image look sharper.
</p>

<!-- 三张图并排 -->
<div style="display:flex; justify-content:center; gap:30px; flex-wrap:wrap; max-width:1000px; margin:auto;">

  <div style="text-align:center; width:250px;">
    <img src="Blurred_Gaussian.jpg" alt="Blurred (Gaussian)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Blurred (Gaussian)</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="High_Frequencies1.3.jpg" alt="High Frequencies" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">High Frequencies</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="Sharpened.jpg" alt="Sharpened" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Sharpened</div>
  </div>

</div>
<!-- My Image Section -->
<h3 style="margin-top:40px; text-align:left;">My image</h3>

<!-- 图片展示区域 -->
<div style="display:flex; justify-content:center; gap:30px; flex-wrap:wrap; max-width:1100px; margin:auto;">

  <div style="text-align:center; width:250px;">
    <img src="myimg.jpg" alt="Original" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Original</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="myBlurred_Gaussian.jpg" alt="Blurred (Gaussian)" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Blurred (Gaussian)</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="myHigh_Frequencies.jpg" alt="High Frequencies" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">High Frequencies</div>
  </div>

  <div style="text-align:center; width:250px;">
    <img src="mySharpened.jpg" alt="Sharpened" style="width:250px; border:1px solid #ccc; border-radius:8px;">
    <div style="margin-top:8px; font-size:16px;">Sharpened</div>
  </div>

</div>

<h2>Part 2.2: Hybrid Images</h2>

<p>
In this part, we create hybrid images by combining the high-frequency components of one image with the low-frequency components of another. The process involves aligning the input images, extracting the respective frequency components using Gaussian filtering, and then summing them to produce the final hybrid image. To better understand the frequency content at each stage, we also show the log-magnitude of the Fourier transforms for the input images, the filtered images, and the final hybrid image.
</p>

<!-- 第一行：原图1 → 对齐1 → FFT1 -->
<div style="text-align:center; margin-bottom: 20px;">
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Original_Image_1_Highfreq.jpg" width="200"><br>
        <figcaption>Original Image 1</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">&#8594;</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Aligned_Image_1.jpg" width="200"><br>
        <figcaption>Aligned Image 1</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">&#8594;</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="FFT_Input_Image_1.jpg" width="200"><br>
        <figcaption>FFT Image 1</figcaption>
    </figure>
</div>

<!-- 第二行：原图2 → 对齐2 → FFT2 -->
<div style="text-align:center; margin-bottom: 20px;">
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Original_Image_2_Lowfreq.jpg" width="200"><br>
        <figcaption>Original Image 2</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">&#8594;</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Aligned_Image_2.jpg" width="200"><br>
        <figcaption>Aligned Image 2</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">&#8594;</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="FFT_Input_Image_2.jpg" width="200"><br>
        <figcaption>FFT Image 2</figcaption>
    </figure>
</div>

<!-- 第三行：高频 + 低频 = 合成 -->
<div style="text-align:center; margin-bottom: 20px;">
    <figure style="display:inline-block; margin:0 10px;">
        <img src="High_Frequencies2.2.jpg" width="200"><br>
        <figcaption>High Frequencies</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">+</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Low_Frequencies.jpg" width="200"><br>
        <figcaption>Low Frequencies</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">=</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="Hybrid_Image_sigma8_10.jpg" width="200"><br>
        <figcaption>Hybrid Image</figcaption>
    </figure>
</div>

<!-- 第四行：FFT 高频 + FFT 低频 = FFT 合成 -->
<div style="text-align:center; margin-bottom: 20px;">
    <figure style="display:inline-block; margin:0 10px;">
        <img src="FFT_High_Frequencies.jpg" width="200"><br>
        <figcaption>FFT High Frequencies</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">+</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="FFT_Low_Frequencies.jpg" width="200"><br>
        <figcaption>FFT Low Frequencies</figcaption>
    </figure>
    <span style="font-size:30px; vertical-align:middle;">=</span>
    <figure style="display:inline-block; margin:0 10px;">
        <img src="FFT_Hybrid_sigma8_10.jpg" width="200"><br>
        <figcaption>FFT Hybrid Image</figcaption>
    </figure>
</div>

  <h1>Part 2.4: Multiresolution Blending (a.k.a. the oraple!)</h1>

<div class="description">
    <p>
        在这一部分，我实现了苹果和橘子的多分辨率融合（Multiresolution Blending）。 
        我使用了 <strong>平滑的 Gaussian mask</strong> 来控制左右图像的融合区域，并且对每一层图像构建了 <strong>Laplacian 金字塔</strong>（带通滤波），通过逐层融合高频和低频信息，实现了自然平滑的过渡。
    </p>
    <p>
        简单来说，我的流程如下：
        <ol>
            <li>对原图像构建 Gaussian stack，每层进行不同程度的高斯模糊。</li>
            <li>通过相邻 Gaussian 层相减得到带通的 Laplacian stack。</li>
            <li>构建平滑的 mask，用于左右图像的分区融合。</li>
            <li>逐层使用 mask 对 Laplacian 层进行加权融合。</li>
            <li>从最低频层向上累加，得到最终融合图像。</li>
        </ol>
    </p>
    <p>
        最终成功实现了苹果和橘子的平滑融合，既保留了每层的细节纹理，又保持了自然的颜色过渡。
    </p>
</div>

<!-- Laplacian L0 -->
<div class="image-row">
    <div class="image-container">
        <img src="Apple_L0.jpg" alt="Apple L0">
        <div class="caption">Apple L0</div>
    </div>
    <div class="image-container">
        <img src="Orange_L0.jpg" alt="Orange L0">
        <div class="caption">Orange L0</div>
    </div>
    <div class="image-container">
        <img src="Blend_L0.jpg" alt="Blend L0">
        <div class="caption">Blend L0</div>
    </div>
</div>

<!-- Laplacian L2 -->
<div class="image-row">
    <div class="image-container">
        <img src="Apple_L2.jpg" alt="Apple L2">
        <div class="caption">Apple L2</div>
    </div>
    <div class="image-container">
        <img src="Orange_L2.jpg" alt="Orange L2">
        <div class="caption">Orange L2</div>
    </div>
    <div class="image-container">
        <img src="Blend_L2.jpg" alt="Blend L2">
        <div class="caption">Blend L2</div>
    </div>
</div>

<!-- Laplacian L4 -->
<div class="image-row">
    <div class="image-container">
        <img src="Apple_L4.jpg" alt="Apple L4">
        <div class="caption">Apple L4</div>
    </div>
    <div class="image-container">
        <img src="Orange_L4.jpg" alt="Orange L4">
        <div class="caption">Orange L4</div>
    </div>
    <div class="image-container">
        <img src="Blend_L4.jpg" alt="Blend L4">
        <div class="caption">Blend L4</div>
    </div>
</div>

<!-- Original Masked + Final Blend -->
<div class="image-row">
    <div class="image-container">
        <img src="Apple_masked.jpg" alt="Apple Masked">
        <div class="caption">Apple * Mask</div>
    </div>
    <div class="image-container">
        <img src="Orange_masked.jpg" alt="Orange Masked">
        <div class="caption">Orange * (1-Mask)</div>
    </div>
    <div class="image-container">
        <img src="Final_blend.jpg" alt="Final Blend">
        <div class="caption">Final Blend</div>
    </div>
  
</div>
